# λ‹¤μ΄λ‚λ―Ή ν”„λ΅μ‹ κ°μ²΄λ€?
- ν”„λ΅μ‹ κ°μ²΄λ¥Ό λ™μ μΌλ΅ μƒμ„±ν•  μ μκ² ν•΄μ£Όλ” κΈ°λ¥
- κµ¬ν„ ν΄λμ¤λ¥Ό μ‘μ„±ν•μ§€ μ•κ³ λ„ ν”„λ΅μ‹ κ°μ²΄ μƒμ„± κ°€λ¥ -> κµ¬ν„μ²΄ λ³€κ²½μ΄ ν•„μ”ν•  λ• μ‚¬μ©
- λ©”μ†λ“ νΈμ¶μ— λ€ν• μΈν„°μ…‰νΈ, νΈλμ­μ… κ΄€λ¦¬, λ΅κΉ…, κ¶ν• κ²€μ‚¬ λ“± μ‚¬μ©
## vs μ •μ  ν”„λ΅μ‹
```java
public interface PaymentService {
    void pay(int amount);
    void refund(int amount); // μƒλ΅μ΄ λ©”μ†λ“ μ¶”κ°€
}

public class PaymentServiceImpl implements PaymentService {
    @Override
    public void pay(int amount) {
        System.out.println("Paying: " + amount);
    }

    @Override
    public void refund(int amount) {
        System.out.println("Refunding: " + amount);
    }
}

public class StaticPaymentProxy implements PaymentService {
    private PaymentService paymentService;

    public StaticPaymentProxy(PaymentService paymentService) {
        this.paymentService = paymentService;
    }

    @Override
    public void pay(int amount) {
        System.out.println("Before payment");
        paymentService.pay(amount);
        System.out.println("After payment");
    }

    // refund λ©”μ†λ“μ— λ€ν• ν”„λ΅μ‹ λ΅μ§λ„ κµ¬ν„ν•΄μ•Ό ν•¨
    @Override
    public void refund(int amount) {
        System.out.println("Before refund");
        paymentService.refund(amount);
        System.out.println("After refund");
    }
}
```
- ν”„λ΅μ‹λ§λ‹¤ κ°™μ€ κΈ°λ¥μ„ μ¤‘λ³µμΌλ΅ κµ¬ν„ν•΄μ•Ό ν•¨
- λ‹¤λ¥Έ repositoryμ— κΈ°λ¥μ„ μ¶”κ°€ν•  λ•μ—λ” ν”„λ΅μ‹ ν΄λμ¤λ¥Ό μƒλ΅ λ§λ“¤μ–΄μ•Όν•¨

> π’΅ pay, refundμ— λ™μΌν• λ΅μ§μ„ μ¶”κ°€ν•λ‹¤κ³  ν•λ”λΌλ„ λ©”μ†λ“λ§λ‹¤ λ¨λ“  λ΅μ§μ„ μ¤‘λ³µμΌλ΅ μ¶”κ°€ν•΄μ•Ό ν•¨

## μƒμ„±
### 1οΈβƒ£ JDK λ™μ  ν”„λ΅μ‹
- **μΈν„°νμ΄μ¤** κΈ°λ°
- λ¦¬ν”λ ‰μ… μ‚¬μ© (`java.lang.reflect.Proxy`) 
- `java.lang.reflect.InvocationHandler` μΈν„°νμ΄μ¤λ¥Ό κµ¬ν„ν• ν΄λμ¤μ— μν•΄ μ μ–΄
- `InvocationHandler`κ°€ ν”„λ΅μ‹ κ°μ²΄ λ©”μ†λ“ νΈμ¶ μ μ–΄
```java
import java.lang.reflect.InvocationHandler;
import java.lang.reflect.Method;
import java.lang.reflect.Proxy;

public class JdkDynamicProxyDemo {
    public static void main(String[] args) {
        PaymentService originalService = new PaymentServiceImpl(); // μ‹¤μ  μ„λΉ„μ¤ κ°μ²΄
        PaymentService proxyService = (PaymentService) Proxy.newProxyInstance(
                PaymentService.class.getClassLoader(),
                new Class[]{PaymentService.class},
                new InvocationHandler() {
                    @Override
                    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {
                        System.out.println("Before payment");
                        Object result = method.invoke(originalService, args);
                        System.out.println("After payment");
                        return result;
                    }
                });

        proxyService.pay(100);
    }
}
```

### 2οΈβƒ£ CGLIB (Code Generation LIBrary)
- **ν΄λμ¤** κΈ°λ°
- λ°νƒ€μ„ μ‹ λ°”μ΄νΈμ½”λ“ μ΅°μ‘ν•μ—¬ ν”„λ΅μ‹ ν΄λμ¤λ¥Ό λ™μ μΌλ΅ μƒμ„± -> μ„±λ¥μ— μν–¥μ„ μ£Όμ§€λ§ ν”„λ΅μ‹ ν΄λμ¤ μ¬μ‚¬μ© κ°€λ¥
- `net.sf.cglib.proxy.MethodInteceptor` μΈν„°νμ΄μ¤ κµ¬ν„μ„ ν†µν•΄ ν”„λ΅μ‹ κ°μ²΄ λ©”μ†λ“ νΈμ¶ μ μ–΄