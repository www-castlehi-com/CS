# 예외 계층
![](https://i.imgur.com/1svIZ7v.png)
- `Object` : 객체의 최상위 부모. 예외도 객체이므로 최상위 부모가 `Object`
- `Throwable` : 최상위 예외
- `Error` : 메모리 부족이나 심각한 시스템 오류와 같이 애플리케이션에서 **복구 불가능**한 시스템 예외. 언체크 예외
- `Exception` : 체크 예외
	- 애플리케이션 로직에서 사용할 수 있는 실질적인 최상위 예외
	- `RuntimeException`을 제외하고 컴파일러가 체크하는 체크 예외
- `RuntimeException`: 런타임 예외
	- 컴파일러가 체크하지 않는 언체크 예외
# 기본 규칙
## 1️⃣ 예외는 잡아서 처리하거나 던져야 한다
### 예외 처리
![](https://i.imgur.com/UODhm92.png)
- 예외를 처리한 이후에는 애플리케이션 로직이 정상 흐름으로 동작
### 예외 던짐
![](https://i.imgur.com/YFn7ixE.png)
- 호출한 곳으로 계속 예외를 던짐
## 2️⃣ 그 예외의 자식들도 함께 처리된다
- `Exception`을 `catch`로 잡으면 그 하위 예외들도 모두 잡을 수 있다
- `Exception`을 `throws`로 던지면 그 하위 예외들도 모두 던질 수 있다

> **예외를 처리하지 못하고 계속 던지면?**
> - `main()` 쓰레드의 경우 예외 로그를 출력하면서 시스템이 종료
> - WAS의 경우 하나의 예외 때문에 시스템이 종료되면 안되기 때문에 해당 예외를 받아서 처리하며, 주로 개발자가 지정한 오류페이지를 보여줌
# 예외 종류
## 1️⃣ 체크 예외
- `Exception` 중 `RuntimeException`을 제외한 하위 예외
- 컴파일러가 체크
- 잡아서 처리하거나 밖으로 던지도록 선언해야 하며 그렇지 않을 경우 컴파일 오류 발생
### 장단점
**장점**
- 개발자가 실수로 예외를 누락하지 않도록 컴파일러를 통해 문제를 잡아주는 안전 장치
**단점**
- 개발자가 모든 체크 예외를 반드시 잡거나 던지도록 처리해야 하기 때문에 번거로운 일이 됨
- 크게 신경쓰고 싶지 않은 예외까지 모두 챙겨야 함
- 의존관계에 따른 단점 존재
### 원칙
- 기본적으로 언체크 (런타임) 예외 사용
- 예외를 잡아서 반드시 처리해야 하는 문제일 때만 체크 예외 사용
	- 계좌 이체 실패
	- 결제시 포인트 부족
	- 로그인 ID, PW 불일치
### 문제점
![](https://i.imgur.com/p4tc1PO.png)
- 어떤 문제가 발생했는지 자세히 설명하기 어려움
- 해결이 불가능한 공통 예외는 별도의 오류 로그를 남기고, 개발자가 오류를 빨리 인지할 수 있도록 메일, 알림 등을 통해서 전달받는 것이 좋음
#### 1. 복구 불가능한 예외
- 대부분의 예외는 복구가 불가능
- 공통으로 처리하여 오류 로그를 남기고 개발자가 해당 오류를 빠르게 인지하는 것이 필요
- 서블릿 필터, 스프링 인터셉터, 스프링의 `ControllerAdvice`를 사용하여 공통으로 해결
#### 2. 의존 관계에 대한 문제
- `Service`, `Controller`에서 본인이 처리할 수 없어도 `throws`를 던지는 예외를 선언해야 함
  ![](https://i.imgur.com/IRbP1GT.png)
	- ex) `SQLException`이 아닌 `JPAException`으로 변경될 경우 의존성을 가지고 있는 모든 예외 부분들을 고쳐야 함
## 2️⃣ 언체크 예외
- `RuntimeException`과 그 하위 예외
- 컴파일러가 체크 X
- 예외를 던지는 `throws`를 선언하지 않고 생략 가능
	- 주로 생략하지만, 중요한 예외의 경우 선언하기도 함
### 장단점
**장점**
- 신경쓰고 싶지 않은 언체크 예외는 무시 가능
**단점**
- 개발자가 실수로 예외를 누락할 수 있음
### 사용
![](https://i.imgur.com/woo1vQZ.png)
- 중간에 기술이 변경되어도 비즈니스 로직 코드 변경 X
- 예외를 공통으로 처리하는 곳에서 예외 변경에 따른 다른 처리가 필요할 수 있지만 공통 처리하는 곳만 변경하면 됨
### 문서화
- 런타임 예외는 문서화가 필요
- 코드에 `throws 런타임 예외`를 남겨 중요한 예외를 인지하게 함
# 예외 포함, 스택 트레이스
- 로그를 출력할 때 `log.info(" ", e);` 와 같이 예외를 넣어줌
- 예외 전환 시 `throw new RuntimeSQLException(e);`와 같이 기존 예외를 포함하여 전환